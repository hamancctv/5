



<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <meta charset="utf-8">
    <title>GIS ëª¨ë°”ì¼</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
<script type ="text/javascript" src="https://hamancctv.github.io/hamancctv/5/main/mmw.js"> </script>
</head>

    <body>
	<div id="alert-overlay">
    <div id="alert-message"></div>
</div>
		<style>
#container {overflow:hidden;height:100%;position:relative;}
#mapWrapper {width:100%;height:100%;z-index:1;}
#rvWrapper {width:50%;height:100%;top:0;right:0;position:absolute;z-index:0;}
#container.view_roadview #mapWrapper {width: 50%;}
#roadviewControl {position:absolute;top:2px;left:115px;width:42px;height:42px;z-index: 1;cursor: pointer; background: url(https://t1.daumcdn.net/localimg/localimages/07/2018/pc/common/img_search.png) 0 -450px no-repeat;}
#roadviewControl.active {background-position:0 -350px;}
#close {position: absolute;padding: 4px;top: 5px;left: 5px;cursor: pointer;background: #fff;border-radius: 4px;border: 1px solid #c8c8c8;box-shadow: 0px 1px #888;}
#close .img {display: block;background: url(https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/rv_close.png) no-repeat;width: 14px;height: 14px;}

       .custom_typecontrol2_m {position:absolute;bottom:5px;right:10px;overflow:hidden;width:85px;height:25px;margin:0;padding:0;z-index:1;font-size:12px;font-family:'Malgun Gothic', 'ë§‘ì€ ê³ ë”•', sans-serif;}
.custom_typecontrol2_m span {display:block;width:40px;height:30px;float:left;text-align:center;line-height:25px;cursor:pointer;}
.custom_typecontrol2_m .btn {background:#fff;background:linear-gradient(#fff,  #e6e6e6);}       
.custom_typecontrol2_m .btn:hover {background:#f5f5f5;background:linear-gradient(#f5f5f5,#e3e3e3);}
.custom_typecontrol2_m .btn:active {background:#e6e6e6;background:linear-gradient(#e6e6e6, #fff);}    
.custom_typecontrol2_m .selected_btn {color:#fff;background:#425470;background:linear-gradient(#425470, #5b6d8a);}
.custom_typecontrol2_m .selected_btn:hover {color:#fff;}   
       
 html, body {width:100%;height:100%;margin:0;padding:0;overflow: hidden}
        
#menu_wrap {position:absolute;top:40px;right:8px;bottom:70%;width:270px;margin:3px 0 5px 10px;padding:5px;overflow-y:auto;background:rgba(255, 255, 255, 0.8);z-index: 1;font-size:12px;border-radius: 0px;}
.bg_white {background:#fff;}
#menu_wrap hr {display: block; height: 1px;border: 0; border-top: 2px solid #5F5F5F;margin:3px 0;}
#menu_wrap .option{text-align: center;}
  .name:hover { background:#cdcdcd; }     
.bg_white {
    -ms-overflow-style: none; /* IE and Edge */
    scrollbar-width: none; /* Firefox */
}

#menu_rule {position:absolute;left:2;top:45;height:24px;width:197px;margin:0px 0px 0px 0px;padding:5px;overflow-y:none;background:rgba(255, 255, 255, 0.8);z-index: 1;font-size:12px;border-radius: 0px;}
.bg_white {background:#fff;}
#menu_rule hr {display: block; height: 1px;border: 0; border-top: 2px solid #5F5F5F;margin:3px 0;}
#menu_rule .option{text-align: center;}
       
       .info {position:relative;top:5px;left:5px;border-radius:6px;border: 1px solid #ccc;border-bottom:2px solid #ddd;font-size:12px;padding:5px;background:#fff;list-style:none;margin:0;} 
.info:nth-of-type(n) {border:0; box-shadow:0px 1px 2px #888;}    
.number {font-weight:bold;color:#00a0e9;} 

.dot {overflow:hidden;float:left;width:12px;height:12px;background: url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/mini_circle.png');}    
.dotOverlay {position:relative;bottom:10px;border-radius:6px;border: 1px solid #ccc;border-bottom:2px solid #ddd;float:left;font-size:12px;padding:5px;background:#fff;}
.dotOverlay:nth-of-type(n) {border:0; box-shadow:0px 1px 2px #888;}    
.number {font-weight:bold;color:#ee6152;}
.dotOverlay:after {content:'';position:absolute;margin-left:-6px;left:50%;bottom:-8px;width:11px;height:8px;background:url('https://t1.daumcdn.net/localimg/localimages/07/mapapidoc/vertex_white_small.png')}
.distanceInfo {position:relative;top:5px;left:5px;list-style:none;margin:0;}
.distanceInfo .label {display:inline-block;width:50px;}
.distanceInfo:after {content:none;}
       
       /* ì§€ë„ ì „ì²´ì— í•­ìƒ ì† ëª¨ì–‘ */
#map {
    cursor: grab; /* í‰ìƒì‹œ ì† í¸ ìƒíƒœ */
}
       
.marker-pulse {
    position: relative;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background-color: rgba(255, 60, 0, 0.4);
    animation: pulse 1s ease-out infinite;
    transform: translate(-50%, -50%); /* ì¤‘ì‹¬ ë§ì¶”ê¸° */
}

@keyframes pulse {
    0% {
        transform: translate(-50%, -50%) scale(0.5);
        opacity: 0.8;
    }
    100% {
        transform: translate(-50%, -50%) scale(1.5);
        opacity: 0;
    }
}
           
       #alert-overlay {
    position: fixed;
    top: 50px;
    left: 50%;
    transform: translateX(-50%);
    background-color: rgba(0, 0, 0, 0.7);
    color: white;
    padding: 15px 30px;
    border-radius: 8px;
    z-index: 1000;
    display: none;
    font-size: 1.2em;
    font-weight: bold;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}
    </style>

<div id="container">
    <div id="rvWrapper">
        <div id="roadview" style="width:100%;height:100%;"></div> <!-- ë¡œë“œë·°ë¥¼ í‘œì‹œí•  div ì…ë‹ˆë‹¤ -->
        <div id="close" title="ë¡œë“œë·°ë‹«ê¸°" onclick="closeRoadview()"><span class="img"></span></div>
    </div>
    <div id="mapWrapper">
        <div id="map" style="width:100%;height:100%"></div> <!-- ì§€ë„ë¥¼ í‘œì‹œí•  div ì…ë‹ˆë‹¤ -->
        <div id="roadviewControl" onclick="setRoadviewRoad()"></div>
    </div>
</div>
  <!-- 2-2. input:text íƒœê·¸ -->
    <button id="btn_input_copy" style= "position:absolute;top:12;width:45;right:285;z-index:200">ë³µì‚¬</button>
 <input type="text" inputmode="none" class='form-control' style= "position:absolute;top:13;width:270;right:10;z-index:20" id = "gpsyx" value ="35.2725308711779, 128.406307024695">
  <!-- 2-3. í† ê¸€ë²„íŠ¼ -->
<div id="menu_rule" class="bg_white" style="border:1px solid #919191;border-radius:5px;">   
<button id='btnMARKER'>ê±°ë¦¬</button>
<button id='btnPOLYLINE'>ë©´ì </button>
<button id='btnARROW'>ë°˜ê²½</button>
<button class='berror'>ì´ˆê¸°í™”</button>
    </div>
    <!-- ì „ìš©íšŒì„  ë²„íŠ¼ -->
   <button tabindex="-1" id="toggle_group" style="position:absolute;top:90;width:65;left:5;z-index:20">ì „ìš©íšŒì„ </button>


 <input type="search" id="keyword" onkeyup="filter()" onkeydown="if(event.keyCode === 13) { btnsearch_click(); }" class="clickdown" style="position:absolute;top:13;width:200;left:210;z-index:200"/>
   <button tabindex="-1" id="searchBtn" onclick="btnsearch_click()" style="position:absolute;top:12;width:45;left:160;z-index:20" class="bsuccess">ê²€ìƒ‰</button>
<div class="custom_typecontrol2_m radius_border">
	<span id="btnCurrentMe" class="btn" onclick="mapCurrentPosition2()">ë‚´ìœ„ì¹˜</span>
	<span id="btnCurrentHideMe" class="selected_btn" onclick="mapCurrentPositionHide()">ìˆ¨ê¹€</span>
</div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=2634b7b6dd61e41a4d6c0bf40a2ef820&libraries=services,clusterer,drawing"></script>
<script src="https://code.jquery.com/jquery-3.6.1.js" integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI=" crossorigin="anonymous"></script>
// ë§ˆì»¤ë¥¼ í‘œì‹œí•  ìœ„ì¹˜ì™€ ë‚´ìš©ì„ ê°€ì§€ê³  ìˆëŠ” ê°ì²´ ë°°ì—´ì…ë‹ˆë‹¤ 
<!-- ë§ˆì»¤ìœ„ì¹˜ positions.js ë¶ˆëŸ¬ì˜¤ê¸° -->
    <script type="text/javascript" src="https://hamancctv.github.io/5/positions.js"></script> 
    
    <script>
var overlayOn = false, // ì§€ë„ ìœ„ì— ë¡œë“œë·° ì˜¤ë²„ë ˆì´ê°€ ì¶”ê°€ëœ ìƒíƒœë¥¼ ê°€ì§€ê³  ìˆì„ ë³€ìˆ˜
    container = document.getElementById('container'), // ì§€ë„ì™€ ë¡œë“œë·°ë¥¼ ê°ì‹¸ê³  ìˆëŠ” div ì…ë‹ˆë‹¤
    mapWrapper = document.getElementById('mapWrapper'), // ì§€ë„ë¥¼ ê°ì‹¸ê³  ìˆëŠ” div ì…ë‹ˆë‹¤
    mapContainer = document.getElementById('map'), // ì§€ë„ë¥¼ í‘œì‹œí•  div ì…ë‹ˆë‹¤ 
    rvContainer = document.getElementById('roadview'); //ë¡œë“œë·°ë¥¼ í‘œì‹œí•  div ì…ë‹ˆë‹¤


var mapCenter = new kakao.maps.LatLng(35.2725308711779, 128.406307024695), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
    mapOption = {
        center: mapCenter, // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
        level: 4, // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨ 
	              //  mapTypeId: kakao.maps.MapTypeId.HYBRID

    };

// ì§€ë„ë¥¼ í‘œì‹œí•  divì™€ ì§€ë„ ì˜µì…˜ìœ¼ë¡œ ì§€ë„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
var map = new kakao.maps.Map(mapContainer, mapOption);
map.setMaxLevel(9);

// ë¡œë“œë·° ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤ 
var rv = new kakao.maps.Roadview(rvContainer); 

// ì¢Œí‘œë¡œë¶€í„° ë¡œë“œë·° íŒŒë…¸ë¼ë§ˆ IDë¥¼ ê°€ì ¸ì˜¬ ë¡œë“œë·° í´ë¼ì´ì–¸íŠ¸ ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤ 
var rvClient = new kakao.maps.RoadviewClient(); 

// ë¡œë“œë·°ì— ì¢Œí‘œê°€ ë°”ë€Œì—ˆì„ ë•Œ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤ 
kakao.maps.event.addListener(rv, 'position_changed', function() {

    // í˜„ì¬ ë¡œë“œë·°ì˜ ìœ„ì¹˜ ì¢Œí‘œë¥¼ ì–»ì–´ì˜µë‹ˆë‹¤ 
    var rvPosition = rv.getPosition();

    // ì§€ë„ì˜ ì¤‘ì‹¬ì„ í˜„ì¬ ë¡œë“œë·°ì˜ ìœ„ì¹˜ë¡œ ì„¤ì •í•©ë‹ˆë‹¤
    map.setCenter(rvPosition);

    // ì§€ë„ ìœ„ì— ë¡œë“œë·° ë„ë¡œ ì˜¤ë²„ë ˆì´ê°€ ì¶”ê°€ëœ ìƒíƒœì´ë©´
    if(overlayOn) {
        // ë§ˆì»¤ì˜ ìœ„ì¹˜ë¥¼ í˜„ì¬ ë¡œë“œë·°ì˜ ìœ„ì¹˜ë¡œ ì„¤ì •í•©ë‹ˆë‹¤
        marker.setPosition(rvPosition);
    }
});

// ë§ˆì»¤ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
var markImage = new kakao.maps.MarkerImage(
    'https://t1.daumcdn.net/localimg/localimages/07/2018/pc/roadview_minimap_wk_2018.png',
    new kakao.maps.Size(26, 46),
    {
        // ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
        // ìŠ¤í”„ë¼ì´íŠ¸ ì´ë¯¸ì§€ ì „ì²´ì˜ í¬ê¸°ë¥¼ ì§€ì •í•˜ê³ 
        spriteSize: new kakao.maps.Size(1666, 168),
        // ì‚¬ìš©í•˜ê³  ì‹¶ì€ ì˜ì—­ì˜ ì¢Œìƒë‹¨ ì¢Œí‘œë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.
        // background-positionìœ¼ë¡œ ì§€ì •í•˜ëŠ” ê°’ì´ë©° ë¶€í˜¸ëŠ” ë°˜ëŒ€ì…ë‹ˆë‹¤.
        spriteOrigin: new kakao.maps.Point(705, 114),
        offset: new kakao.maps.Point(13, 46)
    }
);

// ë“œë˜ê·¸ê°€ ê°€ëŠ¥í•œ ë§ˆì»¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
var marker = new kakao.maps.Marker({
    image : markImage,
    position: mapCenter,
    draggable: true
});

// ë§ˆì»¤ì— dragend ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤
kakao.maps.event.addListener(marker, 'dragend', function(mouseEvent) {

    // í˜„ì¬ ë§ˆì»¤ê°€ ë†“ì¸ ìë¦¬ì˜ ì¢Œí‘œì…ë‹ˆë‹¤ 
    var position = marker.getPosition();

    // ë§ˆì»¤ê°€ ë†“ì¸ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¡œë“œë·°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤
    toggleRoadview(position);
});

//ì§€ë„ì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤
kakao.maps.event.addListener(map, 'click', function(mouseEvent){
    
    // ì§€ë„ ìœ„ì— ë¡œë“œë·° ë„ë¡œ ì˜¤ë²„ë ˆì´ê°€ ì¶”ê°€ëœ ìƒíƒœê°€ ì•„ë‹ˆë©´ í´ë¦­ì´ë²¤íŠ¸ë¥¼ ë¬´ì‹œí•©ë‹ˆë‹¤ 
    if(!overlayOn) {
        return;
    }

    // í´ë¦­í•œ ìœ„ì¹˜ì˜ ì¢Œí‘œì…ë‹ˆë‹¤ 
    var position = mouseEvent.latLng;

    // ë§ˆì»¤ë¥¼ í´ë¦­í•œ ìœ„ì¹˜ë¡œ ì˜®ê¹ë‹ˆë‹¤
    marker.setPosition(position);

    // í´ë½í•œ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë¡œë“œë·°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤
    toggleRoadview(position);
});

// ì „ë‹¬ë°›ì€ ì¢Œí‘œ(position)ì— ê°€ê¹Œìš´ ë¡œë“œë·°ì˜ íŒŒë…¸ë¼ë§ˆ IDë¥¼ ì¶”ì¶œí•˜ì—¬
// ë¡œë“œë·°ë¥¼ ì„¤ì •í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
function toggleRoadview(position){
    rvClient.getNearestPanoId(position, 50, function(panoId) {
        // íŒŒë…¸ë¼ë§ˆ IDê°€ null ì´ë©´ ë¡œë“œë·°ë¥¼ ìˆ¨ê¹ë‹ˆë‹¤
        if (panoId === null) {
            toggleMapWrapper(true, position);
        } else {
         toggleMapWrapper(false, position);

            // panoIdë¡œ ë¡œë“œë·°ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤
            rv.setPanoId(panoId, position);
        }
    });
}

// ì§€ë„ë¥¼ ê°ì‹¸ê³  ìˆëŠ” divì˜ í¬ê¸°ë¥¼ ì¡°ì •í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
function toggleMapWrapper(active, position) {
    if (active) {

        // ì§€ë„ë¥¼ ê°ì‹¸ê³  ìˆëŠ” divì˜ ë„ˆë¹„ê°€ 100%ê°€ ë˜ë„ë¡ classë¥¼ ë³€ê²½í•©ë‹ˆë‹¤ 
        container.className = '';

        // ì§€ë„ì˜ í¬ê¸°ê°€ ë³€ê²½ë˜ì—ˆê¸° ë•Œë¬¸ì— relayout í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤
        map.relayout();

        // ì§€ë„ì˜ ë„ˆë¹„ê°€ ë³€ê²½ë  ë•Œ ì§€ë„ì¤‘ì‹¬ì„ ì…ë ¥ë°›ì€ ìœ„ì¹˜(position)ë¡œ ì„¤ì •í•©ë‹ˆë‹¤
        map.setCenter(position);
    } else {

        // ì§€ë„ë§Œ ë³´ì—¬ì§€ê³  ìˆëŠ” ìƒíƒœì´ë©´ ì§€ë„ì˜ ë„ˆë¹„ê°€ 50%ê°€ ë˜ë„ë¡ classë¥¼ ë³€ê²½í•˜ì—¬
        // ë¡œë“œë·°ê°€ í•¨ê»˜ í‘œì‹œë˜ê²Œ í•©ë‹ˆë‹¤
        if (container.className.indexOf('view_roadview') === -1) {
            container.className = 'view_roadview';

            // ì§€ë„ì˜ í¬ê¸°ê°€ ë³€ê²½ë˜ì—ˆê¸° ë•Œë¬¸ì— relayout í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤
            map.relayout();

            // ì§€ë„ì˜ ë„ˆë¹„ê°€ ë³€ê²½ë  ë•Œ ì§€ë„ì¤‘ì‹¬ì„ ì…ë ¥ë°›ì€ ìœ„ì¹˜(position)ë¡œ ì„¤ì •í•©ë‹ˆë‹¤
            map.setCenter(position);
        }
    }
}

// ì§€ë„ ìœ„ì˜ ë¡œë“œë·° ë„ë¡œ ì˜¤ë²„ë ˆì´ë¥¼ ì¶”ê°€,ì œê±°í•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
function toggleOverlay(active) {
    if (active) {
        overlayOn = true;

        // ì§€ë„ ìœ„ì— ë¡œë“œë·° ë„ë¡œ ì˜¤ë²„ë ˆì´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤
        map.addOverlayMapTypeId(kakao.maps.MapTypeId.ROADVIEW);

        // ì§€ë„ ìœ„ì— ë§ˆì»¤ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤
        marker.setMap(map);
        marker1.setMap(null); //fë¡œë“œë·° ì˜¤ë²„ë ˆì´ì¼ ë•Œ í´ë¦­ë§ˆì»¤ ì§€ì›€

        // ë§ˆì»¤ì˜ ìœ„ì¹˜ë¥¼ ì§€ë„ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤ 
        marker.setPosition(map.getCenter());

        // ë¡œë“œë·°ì˜ ìœ„ì¹˜ë¥¼ ì§€ë„ ì¤‘ì‹¬ìœ¼ë¡œ ì„¤ì •í•©ë‹ˆë‹¤
        toggleRoadview(map.getCenter());
    } else {
        overlayOn = false;

        // ì§€ë„ ìœ„ì˜ ë¡œë“œë·° ë„ë¡œ ì˜¤ë²„ë ˆì´ë¥¼ ì œê±°í•©ë‹ˆë‹¤
        map.removeOverlayMapTypeId(kakao.maps.MapTypeId.ROADVIEW);

        // ì§€ë„ ìœ„ì˜ ë§ˆì»¤ë¥¼ ì œê±°í•©ë‹ˆë‹¤
        marker.setMap(null);
                marker1.setMap(map); //fë¡œë“œë·° ì˜¤ë²„ë ˆì´ì¼ ë•Œ í´ë¦­ë§ˆì»¤ ì§€ì›€

    }
}

// ì§€ë„ ìœ„ì˜ ë¡œë“œë·° ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
function setRoadviewRoad() {
    var control = document.getElementById('roadviewControl');

    // ë²„íŠ¼ì´ ëˆŒë¦° ìƒíƒœê°€ ì•„ë‹ˆë©´
    if (control.className.indexOf('active') === -1) {
        control.className = 'active';

        // ë¡œë“œë·° ë„ë¡œ ì˜¤ë²„ë ˆì´ê°€ ë³´ì´ê²Œ í•©ë‹ˆë‹¤
        toggleOverlay(true);
    } else {
        control.className = '';

        // ë¡œë“œë·° ë„ë¡œ ì˜¤ë²„ë ˆì´ë¥¼ ì œê±°í•©ë‹ˆë‹¤
        toggleOverlay(false);
    }
}

// ë¡œë“œë·°ì—ì„œ Xë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œ ë¡œë“œë·°ë¥¼ ì§€ë„ ë’¤ë¡œ ìˆ¨ê¸°ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
function closeRoadview() {
    var position = marker.getPosition();
    toggleMapWrapper(true, position);
}

function setCenter(Lat, Lng) {
    // ì´ë™í•  ìœ„ë„ ê²½ë„ ìœ„ì¹˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤ 
    var moveLatLon = new daum.maps.LatLng(Lat, Lng);
  map.setLevel(1);

    // ì§€ë„ ì¤‘ì‹¬ì„ ì´ë™ ì‹œí‚µë‹ˆë‹¤
    map.panTo(moveLatLon);
var circle = new daum.maps.Circle({
    center : new daum.maps.LatLng(Lat,  Lng),  // ì›ì˜ ì¤‘ì‹¬ì¢Œí‘œ ì…ë‹ˆë‹¤ 
    radius: 50, // ë¯¸í„° ë‹¨ìœ„ì˜ ì›ì˜ ë°˜ì§€ë¦„ì…ë‹ˆë‹¤ 
    strokeWeight: 1, // ì„ ì˜ ë‘ê»˜ì…ë‹ˆë‹¤ 
    strokeColor: '#ffa500', // ì„ ì˜ ìƒ‰ê¹”ì…ë‹ˆë‹¤
    strokeOpacity: 1, // ì„ ì˜ ë¶ˆíˆ¬ëª…ë„ ì…ë‹ˆë‹¤ 1ì—ì„œ 0 ì‚¬ì´ì˜ ê°’ì´ë©° 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ íˆ¬ëª…í•©ë‹ˆë‹¤
    strokeStyle: 'dashed', // ì„ ì˜ ìŠ¤íƒ€ì¼ ì…ë‹ˆë‹¤
    fillColor: '#FF1000', // ì±„ìš°ê¸° ìƒ‰ê¹”ì…ë‹ˆë‹¤
    fillOpacity: 0.3  // ì±„ìš°ê¸° ë¶ˆíˆ¬ëª…ë„ ì…ë‹ˆë‹¤   
}); 

// ì§€ë„ì— ì›ì„ í‘œì‹œí•©ë‹ˆë‹¤ 
circle.setMap(map);     
setTimeout(function(){
circle.setMap(null);    ;
}, 1000);        
}

// ì¼ë°˜ ì§€ë„ì™€ ìŠ¤ì¹´ì´ë·°ë¡œ ì§€ë„ íƒ€ì…ì„ ì „í™˜í•  ìˆ˜ ìˆëŠ” ì§€ë„íƒ€ì… ì»¨íŠ¸ë¡¤ì„ ìƒì„±í•©ë‹ˆë‹¤
var mapTypeControl = new kakao.maps.MapTypeControl();
// ì§€ë„ì— ì»¨íŠ¸ë¡¤ì„ ì¶”ê°€í•´ì•¼ ì§€ë„ìœ„ì— í‘œì‹œë©ë‹ˆë‹¤
// kakao.maps.ControlPositionì€ ì»¨íŠ¸ë¡¤ì´ í‘œì‹œë  ìœ„ì¹˜ë¥¼ ì •ì˜í•˜ëŠ”ë° TOPRIGHTëŠ” ì˜¤ë¥¸ìª½ ìœ„ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤
map.addControl(mapTypeControl, kakao.maps.ControlPosition.TOPLEFT);

// ì§€ë„ í™•ëŒ€ ì¶•ì†Œë¥¼ ì œì–´í•  ìˆ˜ ìˆëŠ”  ì¤Œ ì»¨íŠ¸ë¡¤ì„ ìƒì„±í•©ë‹ˆë‹¤
// var zoomControl = new kakao.maps.ZoomControl();
// map.addControl(zoomControl, kakao.maps.ControlPosition.LEFT);

var myMarker;

navigator.geolocation.getCurrentPosition(function(pos) {

		myPosLat = pos.coords.latitude;
		myPosLng = pos.coords.longitude;

		var markerImage = new kakao.maps.MarkerImage("https://hamancctv.github.io/2/pin_me.png", new kakao.maps.Size(56, 49), {offset: new kakao.maps.Point(28, 49)});
		myMarker = new kakao.maps.Marker({
			map: map,
			position: new kakao.maps.LatLng(myPosLat, myPosLng),
			image: markerImage,
			title : "ë‚´ìœ„ì¹˜",
			clickable: false
		});

});	
	


    // ì¤‘ë³µ ì œê±° ë¡œì§
// unique ê°ì²´ì— lat, lng ë¿ë§Œ ì•„ë‹ˆë¼ markerImageë„ ì²´í¬í•˜ì—¬ ì™„ë²½í•œ ì¤‘ë³µ ì œê±°
var unique = {};
var filtered = [];
for (var i = 0; i < positions.length; i++) {
    var lat = positions[i].latlng.getLat();
    var lng = positions[i].latlng.getLng();
    var key = lat + ',' + lng;

    // ì´ë¯¸ì§€ ì •ë³´ë¥¼ í‚¤ì— ì¶”ê°€í•˜ì—¬ ì •í™•í•œ ì¤‘ë³µì„ ì œê±°
    if (!unique[key]) {
        unique[key] = true;
        filtered.push(positions[i]); // ëŒ€í‘œ ë§ˆì»¤ë§Œ ì €ì¥
    }
}
 
var markers = [];
var overlays = [];

positions.forEach(function(pos) {
    var marker = new kakao.maps.Marker({
        position: new kakao.maps.LatLng(pos.lat, pos.lng),
        map: map
    });

    var overlay = new kakao.maps.CustomOverlay({
        position: marker.getPosition(),
        content: '<div>ì˜¤ë²„ë ˆì´</div>',
        yAnchor: 1 
    });

    markers.push(marker);
    overlays.push(overlay);
});

// ë§ˆì»¤ ìƒì„± ë° ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€ ë¡œì§
var markers = [];
var overlays = [];
var clickOverlays = [];
var polyline = null;
var markerHeight = 42;

for (var i = 0; i < filtered.length; i++) {
    (function(i) {
        var marker2 = new kakao.maps.Marker({
            map: map,
            position: filtered[i].latlng,
            image: filtered[i].markerImage, // filtered ë°ì´í„°ì˜ markerImage ì‚¬ìš©
            clickable: true
        });

         // hoverìš© overlay
        var overlay = new kakao.maps.CustomOverlay({
            position: filtered[i].latlng,
            content: `<div style="
        pointer-events: none;  /* í´ë¦­ ì´ë²¤íŠ¸ ë¬´ì‹œ */
                padding:2px 6px;
                background:rgba(255,255,255,0.9);
                border:1px solid #ccc;
                border-radius:5px;
                font-size:12px;
                white-space: nowrap;
                transform: translateY(-${markerHeight}px);
                user-select: none;
            ">${filtered[i].content}</div>`,
            yAnchor: 1,
            map: null,
            clickable: false
        });

        // í´ë¦­ìš© overlay
        var clickOverlay = new kakao.maps.CustomOverlay({
            position: filtered[i].latlng,
            content: `<div style="
        pointer-events: none;  /* í´ë¦­ ì´ë²¤íŠ¸ ë¬´ì‹œ */
                padding:5px 8px;
                background:rgba(255,255,255,0.95);
                border:1px solid #666;
                border-radius:5px;
                font-size:13px;
                white-space: nowrap;
                transform: translateY(-${markerHeight}px);
                user-select: none;
            ">${filtered[i].content}</div>`,
            yAnchor: 1,
            map: null,
            clickable: false
        });

        // hover ì´ë²¤íŠ¸
        kakao.maps.event.addListener(marker2, 'mouseover', function() {
            if(map.getLevel() > 3 && overlay.getMap() === null) overlay.setMap(map);
    this.setZIndex(999);       // ë§ˆì»¤ ìµœìƒìœ„
    overlay.setZIndex(1000);   // ê´€ë ¨ ì˜¤ë²„ë ˆì´ë„ ìœ„ë¡œ
        });
        kakao.maps.event.addListener(marker2, 'mouseout', function() {
            if(map.getLevel() > 3) setTimeout(function() {
                if(overlay.getMap() !== null) overlay.setMap(null);
            }, 50);
    this.setZIndex(0);         // ê¸°ë³¸ê°’ ë³µì›
    overlay.setZIndex(1);      // ì˜¤ë²„ë ˆì´ ê¸°ë³¸ê°’ ë³µì›
        });
        
        
        // í´ë¦­ ì´ë²¤íŠ¸
 kakao.maps.event.addListener(marker2, 'click', function() {

    // 1. ê¸°ì¡´ í´ë¦­ ì˜¤ë²„ë ˆì´ ì œê±°
    clickOverlays.forEach(function(ov) { ov.setMap(null); });
    clickOverlays = [];

    // 2. í´ë¦­í•œ ë§ˆì»¤ index ì°¾ê¸°
    var index = markers.indexOf(marker2);
    var hoverOverlay = overlays[index]; // í´ë¦­í•œ ë§ˆì»¤ì˜ overlay

    // 3. ëª¨ë“  ë§ˆì»¤ì™€ overlay zIndex ì´ˆê¸°í™”
    markers.forEach(function(m) { m.setZIndex(0); });
    overlays.forEach(function(o) { o.setZIndex(1); });

    // 4. í´ë¦­í•œ ë§ˆì»¤ì™€ overlay ìµœìƒìœ„
    marker2.setZIndex(999);
    hoverOverlay.setZIndex(1000);

    // 5. í´ë¦­ìš© overlay í‘œì‹œ
    clickOverlay.setMap(map);
    clickOverlays.push(clickOverlay);

    // 6. ê·¸ë£¹ í´ë¦¬ë¼ì¸ ì²˜ë¦¬
    if (polyline) polyline.setMap(null);
    var group = marker2.group;
    if (group) {
        var linePath = markers
            .filter(m => m.group === group)
            .map(m => m.getPosition());
        if (linePath.length > 1) {
            polyline = new kakao.maps.Polyline({
                path: linePath,
                strokeWeight: 5,
                strokeColor: '#FF5C5C',
                strokeOpacity: 0.7,
                strokeStyle: 'solid'
            });
            polyline.setMap(map);
        }
    }

    // 7. í´ë¦­ ì‹œ bounce íš¨ê³¼
    var originalPosition = filtered[i].latlng;
    var offset = 0;
    var direction = 1;
    var bounceDuration = 400;

    if (marker2.bounceInterval) clearInterval(marker2.bounceInterval);

    marker2.bounceInterval = setInterval(function() {
        offset += direction * 0.5;
        if (offset >= 5 || offset <= -5) direction *= -1;
        var bouncePosition = new kakao.maps.LatLng(
            originalPosition.getLat(),
            originalPosition.getLng() + (offset / 100000)
        );
        marker2.setPosition(bouncePosition);
    }, 10);

    setTimeout(function() {
        clearInterval(marker2.bounceInterval);
        marker2.setPosition(originalPosition);
    }, bounceDuration);

    // 8. ì¢Œí‘œ input ì—…ë°ì´íŠ¸
    var latlng = marker2.getPosition();
    $('#gpsyx').val(latlng.getLat() + ', ' + latlng.getLng());
});
        
        
        
        // ë§ˆì»¤ ê°ì²´ì— ê·¸ë£¹ ì •ë³´ ì €ì¥
        marker2.group = filtered[i].group;
        markers.push(marker2);
        overlays.push(overlay);
    })(i);
}
    
    
// ì§€ë„ ë ˆë²¨ ë³€ê²½ ê°ì§€
kakao.maps.event.addListener(map, 'idle', function() {
    var level = map.getLevel();
    overlays.forEach(function(o) {
        if(level <= 3) o.setMap(map);
        else o.setMap(null);
    });
});

// ì§€ë„ í´ë¦­ â†’ í´ë¦¬ë¼ì¸ ë° í´ë¦­ ì˜¤ë²„ë ˆì´ ì‚­ì œ
kakao.maps.event.addListener(map, 'click', function() {
    if (polyline) {
        polyline.setMap(null);
        polyline = null;
    }
    clickOverlays.forEach(function(o){ o.setMap(null); });
    clickOverlays = [];
});
        


$(()=>{
  // make divs with an onclick attribute tabbable/clickable
  $('div[onclick]')
    .attr('tabindex', '0')                     // Add tab indexes
    .keypress((evt)=>{
    var key = evt.key;
    evt.preventDefault();                  // Ensure all default keypress
    // actions are not used
    if (key === ' ' || key === 'Enter') {  // Only send click events for Space
      // or Enter keys
      evt.currentTarget.click();         // Run the click event for element
    }
  });
 			
  // activate the first clickable div

});
 
    
   // ì§€ë„ê°€ ì´ë™, í™•ëŒ€, ì¶•ì†Œë¡œ ì¸í•´ ì¤‘ì‹¬ì¢Œí‘œê°€ ë³€ê²½ë˜ë©´ ë§ˆì§€ë§‰ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë„ë¡ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤
kakao.maps.event.addListener(map, 'center_changed', function() {

    // ì§€ë„ì˜  ë ˆë²¨ì„ ì–»ì–´ì˜µë‹ˆë‹¤
    var level = map.getLevel();
    // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œë¥¼ ì–»ì–´ì˜µë‹ˆë‹¤ 
    var latlng = map.getCenter(); 
        $('#gpsyx').val(latlng.getLat() + ', ' + latlng.getLng());  
});
    
// ì „ì—­ ë³€ìˆ˜ (ê²€ìƒ‰ ì‹¤íŒ¨ íšŸìˆ˜ ì¹´ìš´íŠ¸)
var searchFailCount = 0;

function btnsearch_click() {
    $(':focus').blur();

    var bounds = new kakao.maps.LatLngBounds(
      new kakao.maps.LatLng(35.119382493091855, 128.18218076324376), // ë‚¨ì„œìª½ ì¢Œí‘œ
      new kakao.maps.LatLng(35.42383291087308, 128.59320201946082)  // ë¶ë™ìª½ ì¢Œí‘œ
    );

    var geocoder = new kakao.maps.services.Geocoder();
    var geocoderOptions = { bounds: bounds };

    // ì£¼ì†Œ ê²€ìƒ‰
    geocoder.addressSearch($('#keyword').val(), function(result, status) {
        handleSearchResult(result, status, 'address');
    }, geocoderOptions);

    var ps = new kakao.maps.services.Places();
    var psOptions = { bounds: bounds };

    // í‚¤ì›Œë“œ ê²€ìƒ‰
    ps.keywordSearch("í•¨ì•ˆêµ° " + $('#keyword').val(), function(data, status, pagination) {
        handleSearchResult(data, status, 'keyword');
    }, psOptions);

    // ê²€ìƒ‰ ì‹œì‘í•  ë•Œ ì‹¤íŒ¨ ì¹´ìš´íŠ¸ ì´ˆê¸°í™”
    searchFailCount = 0;
}

// ê³µí†µ ì²˜ë¦¬ í•¨ìˆ˜
function handleSearchResult(data, status, searchType) {
    if (status === kakao.maps.services.Status.OK && data.length > 0) {
        var coords = new kakao.maps.LatLng(data[0].y, data[0].x);

        var circle = new kakao.maps.Circle({
            center: coords,
            radius: 50,
            strokeWeight: 1,
            strokeColor: '#ffa500',
            strokeOpacity: 1,
            strokeStyle: 'dashed',
            fillColor: '#FF1000',
            fillOpacity: 0.3
        });

        circle.setMap(map);
        setTimeout(function() {
            circle.setMap(null);
        }, 1000);

        map.setLevel(2);
        map.setCenter(coords);

        // ğŸ”¹ ì„±ê³µí–ˆìœ¼ë©´ ì‹¤íŒ¨ ì¹´ìš´íŠ¸ ë¦¬ì…‹
        searchFailCount = 0;

    } else {
        // ğŸ”¹ ê²€ìƒ‰ ì‹¤íŒ¨ ì‹œ ì¹´ìš´íŠ¸ ì¦ê°€
        searchFailCount++;

        if (searchFailCount >= 2) {
            showAlert("ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
            $('#keyword').focus();
        }
    }
}
// âœ… 7. ì˜¤ë²„ë ˆì´ ê²½ê³ ì°½ì„ ë³´ì—¬ì£¼ëŠ” í•¨ìˆ˜
function showAlert(message) {
    const alertOverlay = $('#alert-overlay');
    const alertMessage = $('#alert-message');
    alertMessage.text(message);
    alertOverlay.fadeIn(300);

    setTimeout(function() {
        alertOverlay.fadeOut(500);
    }, 3000);
}


    
// ì§€ë„ë¥¼ í´ë¦­í•œ ìœ„ì¹˜ì— í‘œì¶œí•  ë§ˆì»¤ì…ë‹ˆë‹¤
    var imageSrc = 'https://raw.githubusercontent.com/kang-chan/hamancctv2/main/rainbow.png', // ë§ˆì»¤ì´ë¯¸ì§€ì˜ ì£¼ì†Œì…ë‹ˆë‹¤    
    imageSize = new kakao.maps.Size(40, 50), // ë§ˆì»¤ì´ë¯¸ì§€ì˜ í¬ê¸°ì…ë‹ˆë‹¤
    imageOption = {offset: new kakao.maps.Point(20, 45)}; // ë§ˆì»¤ì´ë¯¸ì§€ì˜ ì˜µì…˜ì…ë‹ˆë‹¤. ë§ˆì»¤ì˜ ì¢Œí‘œì™€ ì¼ì¹˜ì‹œí‚¬ ì´ë¯¸ì§€ ì•ˆì—ì„œì˜ ì¢Œí‘œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
      


    
// ì§€ë„ì— í´ë¦­ ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤
// ì§€ë„ë¥¼ í´ë¦­í•˜ë©´ ë§ˆì§€ë§‰ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ì–´ì˜¨ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•©ë‹ˆë‹¤
kakao.maps.event.addListener(map, 'click', function(mouseEvent) {        

    // í´ë¦­í•œ ìœ„ë„, ê²½ë„ ì •ë³´ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤
    var latlng = mouseEvent.latLng;
    // ë§ˆì»¤ ìœ„ì¹˜ë¥¼ í´ë¦­í•œ ìœ„ì¹˜ë¡œ ì˜®ê¹ë‹ˆë‹¤
//    marker1.setPosition(latlng);

    //alert(message);
// ì¢Œí‘œ inputì— ì¢Œí‘œ ë„£ê¸°
    $('#gpsyx').val(latlng.getLat() + ', ' + latlng.getLng());  
});


    
</script>


    <div id="menu_rule" class="bg_white" style="border:1px solid #919191;border-radius:5px;">   
        <button id='btnMARKER' onclick="rule_line()">ê±°ë¦¬</button>
	    <button id='btnPOLYLINE'  onclick="rule_poly()">ë©´ì </button>
        <button id='btnARROW'  onclick="rule_circle()">ë°˜ê²½</button>    
        <button class='berror' onclick="RulerRemove()">ì´ˆê¸°í™”</button></div>

    <!-- sel_txt ì‹œì‘ -->
<div id="menu_wrap" class="bg_white" style="border:1px solid #919191;border-radius:10px;">
    // ì´ ì‚¬ì´ì— ë‚´ìš© í˜¸ì¶œ
    </div>
<script>
    fetch("https://raw.githubusercontent.com/hamancctv/5/refs/heads/main/sel_txt.html")  // ì™¸ë¶€ íŒŒì¼ ê²½ë¡œ
  .then(response => response.text())
  .then(html => {
    document.getElementById("menu_wrap").innerHTML = html;
  })
  .catch(err => console.error("ë©”ë‰´ ë¡œë“œ ì‹¤íŒ¨:", err));
</script>
    // ìœ„ ìë°”ìŠ¤í¬ë¦½íŠ¸ê°€ ë‚´ìš© í˜¸ì¶œ ìŠ¤í¬ë¦½íŠ¸ê³  ì´ìƒ ë.
    
<script type="text/javascript">
      function filter(){

        var value, name, item, i;

        value = document.getElementById("keyword").value.toUpperCase();
        item = document.getElementsByClassName("sel_txt");

        for(i=0;i<item.length;i++){
          name = item[i].getElementsByClassName("name");
          if(name[0].innerHTML.toUpperCase().indexOf(value) > -1){
            item[i].style.display = "flex";
          }else{
            item[i].style.display = "none";
          }
        }
      };
    

function removeMarker() {
    for ( var i = 0; i < markers.length; i++ ) {
        markers[i].setMap(null);
    }
    markers = [];
}
     // 2-2. input:text ë³µì‚¬
	  
    document.getElementById("btn_input_copy").onclick = function(){
        const input_text = document.getElementById("gpsyx");
        gpsyx.select();
        document.execCommand('copy');
    };

    // ì „ì—­ ë³€ìˆ˜
var groupPolylineMap = {}; // ê·¸ë£¹ë³„ë¡œ polyline ì €ì¥
var toggleGroupOn = false; // í† ê¸€ ìƒíƒœ

// ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
document.getElementById('toggle_group').addEventListener('click', function() {
    toggleGroupOn = !toggleGroupOn;

    if (toggleGroupOn) {
        // ë²„íŠ¼ í™œì„±í™” ìŠ¤íƒ€ì¼ ì ìš©
        this.classList.add('active');

        // ê·¸ë£¹ë³„ í´ë¦¬ë¼ì¸ ìƒì„± (ê·¸ë£¹ ì •ë³´ ì—†ëŠ” ë§ˆì»¤ ì œì™¸)
        var groups = {};
        markers.forEach(function(marker) {
            if (!marker.group) return; // ê·¸ë£¹ ì—†ëŠ” ë§ˆì»¤ëŠ” ì œì™¸
            if (!groups[marker.group]) groups[marker.group] = [];
            groups[marker.group].push(marker.getPosition());
        });

        for (var g in groups) {
            if (groups[g].length < 2) continue; // í´ë¦¬ë¼ì¸ ê·¸ë¦¬ê¸° ìµœì†Œ 2ê°œ
            var line = new kakao.maps.Polyline({
                path: groups[g],
                strokeWeight: 5,
                strokeColor: '#FF5C5C',
                strokeOpacity: 0.7,
                strokeStyle: 'solid'
            });
            line.setMap(map);
            groupPolylineMap[g] = line; // ê·¸ë£¹ë³„ ì €ì¥
        }

    } else {
        // ë²„íŠ¼ ë¹„í™œì„±í™” ìŠ¤íƒ€ì¼ ì œê±°
        this.classList.remove('active');

        // ëª¨ë“  ê·¸ë£¹ í´ë¦¬ë¼ì¸ ì œê±°
        for (var g in groupPolylineMap) {
            groupPolylineMap[g].setMap(null);
        }
        groupPolylineMap = {};
    }
});

    
 </script>

</body>
</html>
